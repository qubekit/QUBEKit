<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ForceBalanceFitting &mdash; QUBEKit 2.1.1+10.g127b9f1.dirty documentation</title><link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/autodoc_pydantic.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  <script id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/jquery.js"></script>
        <script src="../../../_static/underscore.js"></script>
        <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex/" />
    <link rel="search" title="Search" href="../../../search/" />
    <link rel="next" title="Acknowledgments" href="../../../acknowledgments/" />
    <link rel="prev" title="TorsionScan1D" href="../../torsionscanner/torsionscan1D/" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../../" class="icon icon-home"> QUBEKit
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search/" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../qubekit/">QUBEKit</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../installation/">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../documentation/">Documentation</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../../api/">Staging Classes</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../../api/#parametrisation">Parametrisation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/#optimisation">Optimisation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/#charges">Charges</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/#virtual-sites">Virtual Sites</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/#bonded-modules">Bonded Modules</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/#torsion-scanner">Torsion Scanner</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../../../api/#torsion-optimisation">Torsion Optimisation</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">ForceBalanceFitting</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../acknowledgments/">Acknowledgments</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../license/">License</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../">QUBEKit</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../../../api/">Staging Classes</a> &raquo;</li>
      <li>ForceBalanceFitting</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../../_sources/classes/torsionoptimisation/forcebalancefitting.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="section" id="forcebalancefitting">
<h1>ForceBalanceFitting<a class="headerlink" href="#forcebalancefitting" title="Permalink to this headline">¶</a></h1>
<dl class="py class">
<dt id="qubekit.torsions.fitting.forcebalance_wrapper.ForceBalanceFitting">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">qubekit.torsions.fitting.forcebalance_wrapper.</span></code><code class="sig-name descname"><span class="pre">ForceBalanceFitting</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">type</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">typing_extensions.Literal</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#qubekit.torsions.fitting.forcebalance_wrapper.ForceBalanceFitting" title="qubekit.torsions.fitting.forcebalance_wrapper.ForceBalanceFitting"><span class="pre">ForceBalanceFitting</span></a><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">'ForceBalanceFitting'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">penalty_type</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">typing_extensions.Literal</span><span class="p"><span class="pre">[</span></span><span class="pre">L1</span><span class="p"><span class="pre">,</span> </span><span class="pre">L2</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">'L1'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">job_type</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">'optimize'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_iterations</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">pydantic.types.PositiveInt</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">convergence_step_criteria</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">pydantic.types.PositiveFloat</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">convergence_objective_criteria</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">pydantic.types.PositiveFloat</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">convergence_gradient_criteria</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">pydantic.types.PositiveFloat</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_criteria</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">pydantic.types.PositiveInt</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eig_lowerbound</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">pydantic.types.PositiveFloat</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">finite_difference_h</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">pydantic.types.PositiveFloat</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">penalty_additive</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">pydantic.types.PositiveFloat</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">constrain_charge</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_trust_radius</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">-</span> <span class="pre">0.25</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minimum_trust_radius</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">0.05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_tolerance</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">pydantic.types.PositiveFloat</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">adaptive_factor</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">pydantic.types.PositiveFloat</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">adaptive_damping</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">pydantic.types.PositiveFloat</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize_weights</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extras</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">priors</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">qubekit.torsions.fitting.forcebalance_wrapper.Priors</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">Priors(Proper_k=6.0)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">targets</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span> </span><span class="pre">qubekit.torsions.fitting.forcebalance_wrapper.TorsionProfile</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">{'TorsionProfile_OpenMM':</span> <span class="pre">TorsionProfile(target_name='TorsionProfile_OpenMM',</span> <span class="pre">description='Relaxed</span> <span class="pre">energy</span> <span class="pre">and</span> <span class="pre">RMSD</span> <span class="pre">fitting</span> <span class="pre">for</span> <span class="pre">torsion</span> <span class="pre">drives</span> <span class="pre">only.',</span> <span class="pre">writelevel=2,</span> <span class="pre">keywords={'pdb':</span> <span class="pre">'molecule.pdb',</span> <span class="pre">'coords':</span> <span class="pre">'scan.xyz'},</span> <span class="pre">openmm_platform='Reference',</span> <span class="pre">energy_denom=1.0,</span> <span class="pre">energy_upper=10.0,</span> <span class="pre">attenuate=False,</span> <span class="pre">restrain_k=1.0)}</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/qubekit/torsions/fitting/forcebalance_wrapper/#ForceBalanceFitting"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubekit.torsions.fitting.forcebalance_wrapper.ForceBalanceFitting" title="Permalink to this definition">¶</a></dt>
<dd><p>This class interfaces with forcebalance &lt;<a class="reference external" href="https://github.com/leeping/forcebalance">https://github.com/leeping/forcebalance</a>&gt; and allows users to fit multiple force field parameters
to multiple different targets such as optimised geometries vibration frequencies and relaxed torsion profiles.</p>
<dl class="simple">
<dt>Note:</dt><dd><p>We only support relaxed torsion profile fitting so far.
All targets are fitted using OpenMM.</p>
</dd>
</dl>
<dl class="py method">
<dt id="qubekit.torsions.fitting.forcebalance_wrapper.ForceBalanceFitting.add_target">
<code class="sig-name descname"><span class="pre">add_target</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">target</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">qubekit.torsions.fitting.forcebalance_wrapper.TargetBase</span></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">None</span><a class="reference internal" href="../../../_modules/qubekit/torsions/fitting/forcebalance_wrapper/#ForceBalanceFitting.add_target"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubekit.torsions.fitting.forcebalance_wrapper.ForceBalanceFitting.add_target" title="Permalink to this definition">¶</a></dt>
<dd><p>Try and add the given target class to the forcebalance optimiser to be executed when optimise is called.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>target: The ForceBalance optimisation target that should be added.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="qubekit.torsions.fitting.forcebalance_wrapper.ForceBalanceFitting.check_converged">
<em class="property"><span class="pre">static</span> </em><code class="sig-name descname"><span class="pre">check_converged</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; <span class="pre">bool</span><a class="reference internal" href="../../../_modules/qubekit/torsions/fitting/forcebalance_wrapper/#ForceBalanceFitting.check_converged"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubekit.torsions.fitting.forcebalance_wrapper.ForceBalanceFitting.check_converged" title="Permalink to this definition">¶</a></dt>
<dd><p>Read the output from a forcebalance run to determine the exit status of the optimisation.</p>
<dl class="simple">
<dt>Returns:</dt><dd><p><cite>True</cite> if the optimisation has converged else <cite>False</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="qubekit.torsions.fitting.forcebalance_wrapper.ForceBalanceFitting.collect_results">
<code class="sig-name descname"><span class="pre">collect_results</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">molecule</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">qubekit.molecules.ligand.Ligand</span></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">qubekit.molecules.ligand.Ligand</span><a class="reference internal" href="../../../_modules/qubekit/torsions/fitting/forcebalance_wrapper/#ForceBalanceFitting.collect_results"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubekit.torsions.fitting.forcebalance_wrapper.ForceBalanceFitting.collect_results" title="Permalink to this definition">¶</a></dt>
<dd><p>Collect the results of an optimisation by checking the exit status and then transferring the optimised parameters from the final
xml forcefield back into the ligand.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>molecule: The molecule that was optimised and where the parameters should be stored.</p>
</dd>
<dt>Returns:</dt><dd><p>The input molecule with the optimised parameters saved.</p>
</dd>
<dt>Raises:</dt><dd><p>ForceBalanceError: If the optimisation did not converge or exit properly.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="qubekit.torsions.fitting.forcebalance_wrapper.ForceBalanceFitting.finish_message">
<code class="sig-name descname"><span class="pre">finish_message</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">str</span><a class="reference internal" href="../../../_modules/qubekit/torsions/fitting/forcebalance_wrapper/#ForceBalanceFitting.finish_message"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubekit.torsions.fitting.forcebalance_wrapper.ForceBalanceFitting.finish_message" title="Permalink to this definition">¶</a></dt>
<dd><p>A friendly message to let users know that the stage is complete and any checks that have been performed.</p>
</dd></dl>

<dl class="py method">
<dt id="qubekit.torsions.fitting.forcebalance_wrapper.ForceBalanceFitting.generate_forcefield">
<code class="sig-name descname"><span class="pre">generate_forcefield</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">molecule</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">qubekit.molecules.ligand.Ligand</span></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">None</span><a class="reference internal" href="../../../_modules/qubekit/torsions/fitting/forcebalance_wrapper/#ForceBalanceFitting.generate_forcefield"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubekit.torsions.fitting.forcebalance_wrapper.ForceBalanceFitting.generate_forcefield" title="Permalink to this definition">¶</a></dt>
<dd><p>For the given molecule generate the fitting forcefield with the target torsion terms tagged with the parameterize keyword.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>molecule: The molecule whose torsion parameters should be optimised.</p>
</dd>
<dt>Note:</dt><dd><p>We currently hard code to only fit dihedrals that pass through the targeted rotatable bond.</p>
</dd>
<dt>Important:</dt><dd><p>We work with a copy of the molecule here as we add attributes to the forcefield and change default values.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="qubekit.torsions.fitting.forcebalance_wrapper.ForceBalanceFitting.generate_optimise_in">
<code class="sig-name descname"><span class="pre">generate_optimise_in</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">target_data</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">None</span><a class="reference internal" href="../../../_modules/qubekit/torsions/fitting/forcebalance_wrapper/#ForceBalanceFitting.generate_optimise_in"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubekit.torsions.fitting.forcebalance_wrapper.ForceBalanceFitting.generate_optimise_in" title="Permalink to this definition">¶</a></dt>
<dd><p>For the given list of targets and entries produce an optimize.in file which contains all of the run time settings to be used in the optimization.
this uses jinja templates to generate the required file from the template distributed with qubekit.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>target_data: A dictionary mapping the target name to the target folders that have been created.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="qubekit.torsions.fitting.forcebalance_wrapper.ForceBalanceFitting.group_by_symmetry">
<code class="sig-name descname"><span class="pre">group_by_symmetry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">molecule</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">qubekit.molecules.ligand.Ligand</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dihedrals</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span> </span><span class="pre">int</span><span class="p"><span class="pre">,</span> </span><span class="pre">int</span><span class="p"><span class="pre">,</span> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span> </span><span class="pre">int</span><span class="p"><span class="pre">,</span> </span><span class="pre">int</span><span class="p"><span class="pre">,</span> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><a class="reference internal" href="../../../_modules/qubekit/torsions/fitting/forcebalance_wrapper/#ForceBalanceFitting.group_by_symmetry"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubekit.torsions.fitting.forcebalance_wrapper.ForceBalanceFitting.group_by_symmetry" title="Permalink to this definition">¶</a></dt>
<dd><p>For a list of target dihedrals to be optimised group them by symmetry type.</p>
<dl class="simple">
<dt>Note:</dt><dd><p>Dihedrals not in the target bond but in the same symmetry group are also included.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="qubekit.torsions.fitting.forcebalance_wrapper.ForceBalanceFitting.is_available">
<em class="property"><span class="pre">classmethod</span> </em><code class="sig-name descname"><span class="pre">is_available</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; <span class="pre">bool</span><a class="reference internal" href="../../../_modules/qubekit/torsions/fitting/forcebalance_wrapper/#ForceBalanceFitting.is_available"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubekit.torsions.fitting.forcebalance_wrapper.ForceBalanceFitting.is_available" title="Permalink to this definition">¶</a></dt>
<dd><p>Make sure forcebalance can be imported.</p>
</dd></dl>

<dl class="py method">
<dt id="qubekit.torsions.fitting.forcebalance_wrapper.ForceBalanceFitting.run">
<code class="sig-name descname"><span class="pre">run</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">molecule</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">qubekit.molecules.ligand.Ligand</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">qubekit.molecules.ligand.Ligand</span><a class="reference internal" href="../../../_modules/qubekit/torsions/fitting/forcebalance_wrapper/#ForceBalanceFitting.run"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubekit.torsions.fitting.forcebalance_wrapper.ForceBalanceFitting.run" title="Permalink to this definition">¶</a></dt>
<dd><p>The main run method of the ForceBalance torsion optimisation stage.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>molecule: The molecule that should be optimised with its QM reference data.</p>
</dd>
<dt>Important:</dt><dd><p>We work on a copy of the molecule as we have to change some parameters.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="qubekit.torsions.fitting.forcebalance_wrapper.ForceBalanceFitting.start_message">
<code class="sig-name descname"><span class="pre">start_message</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">str</span><a class="reference internal" href="../../../_modules/qubekit/torsions/fitting/forcebalance_wrapper/#ForceBalanceFitting.start_message"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qubekit.torsions.fitting.forcebalance_wrapper.ForceBalanceFitting.start_message" title="Permalink to this definition">¶</a></dt>
<dd><p>A friendly message to let users know that stage is starting with any important options.</p>
</dd></dl>

</dd></dl>

</div>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../../torsionscanner/torsionscan1D/" class="btn btn-neutral float-left" title="TorsionScan1D" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../../../acknowledgments/" class="btn btn-neutral float-right" title="Acknowledgments" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, Daniel J Cole.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>